# Задача 3: Трансформатор данных из API

import json

# Исходные данные API на русском
исходные_данные = {
    "местоположение": {
        "город": "Москва",
        "код_страны": "RU"
    },
    "прогноз": {
        "ежедневно": {
            "температура": [5, 8, 3, 1, 6],
            "погода": ["облачно", "солнечно", "дождь", "снег", "облачно"]
        }
    }
}

def transform_weather_data(данные):
    """Преобразует данные о погоде в удобный формат"""
    
    # Извлекаем информацию о местоположении
    город = данные["местоположение"]["город"]
    страна = данные["местоположение"]["код_страны"]
    местоположение = f"{город}, {страна}"
    
    # Извлекаем массивы температуры и погоды
    температуры = данные["прогноз"]["ежедневно"]["температура"]
    погода = данные["прогноз"]["ежедневно"]["погода"]
    
    # Преобразуем в список объектов
    результат = []
    for день, (темп, погод) in enumerate(zip(температуры, погода)):
        результат.append({
            "день": день,
            "температура": темп,
            "погода": погод,
            "местоположение": местоположение
        })
    
    return результат

# Сохраняем исходные данные
with open('исходные_данные_погоды.json', 'w', encoding='utf-8') as f:
    json.dump(исходные_данные, f, ensure_ascii=False, indent=2)

# Преобразуем данные
преобразованные_данные = transform_weather_data(исходные_данные)

# Сохраняем преобразованные данные
with open('преобразованные_данные_погоды.json', 'w', encoding='utf-8') as f:
    json.dump(преобразованные_данные, f, ensure_ascii=False, indent=2)

# Выводим результат
print("=== ИСХОДНЫЕ ДАННЫЕ ===")
print(json.dumps(исходные_данные, ensure_ascii=False, indent=2))

print("\n=== ПРЕОБРАЗОВАННЫЕ ДАННЫЕ ===")
print(json.dumps(преобразованные_данные, ensure_ascii=False, indent=2))

# Дополнительная статистика
print(f"\n=== СТАТИСТИКА ===")
print(f"Местоположение: {преобразованные_данные[0]['местоположение']}")
print(f"Количество дней: {len(преобразованные_данные)}")

средняя_температура = sum(день['температура'] for день in преобразованные_данные) / len(преобразованные_данные)
print(f"Средняя температура: {средняя_температура:.1f}°C")

# Подсчет типов погоды
типы_погоды = {}
for день in преобразованные_данные:
    погода = день['погода']
    типы_погоды[погода] = типы_погоды.get(погода, 0) + 1

print("Типы погоды:")
for тип, количество in типы_погоды.items():
    print(f"  {тип}: {количество} дней")